name = "voxelcraft-ai"
main = "src/index.js"
compatibility_date = "2026-02-13"
workers_dev = true

[[migrations]]
tag = "v1"
new_sqlite_classes = ["WorldCoordinator"]

[env.staging]
name = "voxelcraft-ai-staging"

[[env.staging.containers]]
class_name = "WorldCoordinator"
image = "../Dockerfile.cloudflare"
max_instances = 6

[[env.staging.durable_objects.bindings]]
name = "VOXEL_WORLD"
class_name = "WorldCoordinator"

[env.staging.vars]
DEPLOY_ENV = "staging"
DEFAULT_WORLD_ID = "world_1"
VC_R2_MIRROR = "true"
VC_R2_ENDPOINT = "https://__CF_ACCOUNT_ID__.r2.cloudflarestorage.com"
VC_R2_BUCKET = "__R2_BUCKET_NAME__"
VC_R2_PREFIX = "voxelcraft-ai"
VC_R2_UPLOAD_WORKERS = "2"

[[env.staging.d1_databases]]
binding = "VOXEL_D1"
database_name = "voxelcraft-ai-staging"
database_id = "__D1_DATABASE_ID__"

[[env.staging.r2_buckets]]
binding = "VOXEL_R2"
bucket_name = "__R2_BUCKET_NAME__"

[[env.staging.routes]]
pattern = "staging-api.voxelcraft.ai"
custom_domain = true

[env.production]
name = "voxelcraft-ai-production"

[[env.production.containers]]
class_name = "WorldCoordinator"
image = "../Dockerfile.cloudflare"
max_instances = 6

[[env.production.durable_objects.bindings]]
name = "VOXEL_WORLD"
class_name = "WorldCoordinator"

[env.production.vars]
DEPLOY_ENV = "production"
DEFAULT_WORLD_ID = "world_1"
VC_R2_MIRROR = "true"
VC_R2_ENDPOINT = "https://__CF_ACCOUNT_ID__.r2.cloudflarestorage.com"
VC_R2_BUCKET = "__R2_BUCKET_NAME__"
VC_R2_PREFIX = "voxelcraft-ai"
VC_R2_UPLOAD_WORKERS = "2"

[[env.production.d1_databases]]
binding = "VOXEL_D1"
database_name = "voxelcraft-ai-production"
database_id = "__D1_DATABASE_ID__"

[[env.production.r2_buckets]]
binding = "VOXEL_R2"
bucket_name = "__R2_BUCKET_NAME__"

[[env.production.routes]]
pattern = "api.voxelcraft.ai"
custom_domain = true
